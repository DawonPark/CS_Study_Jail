# Race Condition

**정의**

-   두 개 이상의 프로세스나 스레드들이 하나의 공유된 자원에 동기화 매커니즘 없이 접근하려고 하는 상황 → 이러한 상황은 문제를 발생할 시킬 수 있음. 간단하게 통장에 100만원이 있는데 동시에 두 이상의 요청으로 각 요청이 50만원 ,60만원이라면 100만원 이상이 이체되는 상황이 발생할 수 있음.

**발생 경우**

**1) 커널 작업을 수행하는 중 인터럽트가 발생하는 경우**

-   문제점 : 커널모드에서 데이터를 로드하여 작업을 수행하다가 인터럽트가 발생하여 같은 데이터를 조작하는 경우 ⇒ 사용자 프로세스는 해당 프로세스에 할당 받은 메모리에만 존재할 수 있지만 커널은 서로 다른 프로세스가 공유하기 때문에 발생
-   해결법 : 커널모드에서 작업을 수행하는 동안 인터럽트를 disable 시켜 CPU 제어권을 가져가지 못하도록 한다.

**2) 프로세스가 시스템 콜(System Call)을 호출하여 커널 모드로 수행하는 도중 Context Switch가 발생하는 경우**

-   문제점 : 프로세스1이 커널모드에서 데이터를 조작하는 도중, 시간이 초과되어 CPU 제어권이 프로세스2로 넘어가 같은 데이터를 조작하는 경우
-   해결법 : 프로세스가 커널모드에서 작업을 하는 경우 시간이 초과되어도 CPU 제어권이 다른 프로세스에게 넘어가지 않도록 한다.

**3) 멀티 프로세서 환경에서 여러 프로세스가 공유 메모리 내 커널 안 변수에 접근하는 경우**

-   문제점 : 멀티 프로세서 환경에서 2개의 CPU가 동시에 커널 내부의 공유 데이터에 접근하여 조작하는 경우
-   해결법 : 커널 내부에 있는 각 공유 데이터에 접근할 때마다, 그 데이터에 대한 lock/unlock을 한다. ⇒ 매 순간 그 데이터에 접근하는 프로세스는 1개

**참고사이트**

[https://github.com/haewon-park/csStudy/blob/9719e20415b6c58658e432b74bc02090b21db5c4/OS/Race condition.md](https://github.com/haewon-park/csStudy/blob/9719e20415b6c58658e432b74bc02090b21db5c4/OS/Race%20condition.md)

[https://ko.wikipedia.org/wiki/경쟁\_상태](https://ko.wikipedia.org/wiki/%EA%B2%BD%EC%9F%81_%EC%83%81%ED%83%9C)
