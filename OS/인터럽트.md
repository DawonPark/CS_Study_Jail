# [OS] 인터럽트(Interrupt)

상태: 완료 🙌
작성일시: 2022년 3월 3일 오후 7:52

# 1. 인터럽트란?

- 프로그램을 실행하는 중에 예기치 않은 상황이 발생했을 때 현재 실행 중인 작업을 중단하고 발생된 상황에 대한 처리가 필요함을 CPU에게 전달하는 것
- 현재 진행 중인 작업보다 우선순위가 높은 작업이라면 해당 작업을 먼저 처리해야 함
- 입출력 장치와 같은 주변장치들은 인터럽트로 관리됨
    - 입출력 연산의 경우 CPU의 수행속도보다 현저히 느리기 때문에 CPU를 작업시간을 낭비하게 되므로 다른 작업을 처리하도록 CPU를 넘기고 끝나면 CPU에 다시 알려 이전 작업을 이어가도록 함

# 2. 인터럽트의 종류

### 2-1. 외부 인터럽트(하드웨어 인터럽트)

- CPU의 하드웨어 신호에 의해 발생
    - 외부 인터럽트
        - 입출력, 외부 신호, 전원 이상 등 장치의 문제나 신호 등 외부적인 요인으로 발생
        
        > 키보드, 프린터 등의 I/O 이벤트, 타이버 이벤트 등
        > 

### 2-2. 내부 인터럽트

- 내부 인터럽트
    - Trap이라고도 부름
    - 잘못된 명령이나 데이터의  이상 시 발생
        
        > 0으로 나눌 때, 오버플로우, Exception 발생, System call 등
        > 
        

### 2-3. 소프트웨어 인터럽트

- 프로그램의 처리 중 요청에 의해 발생(SVC 인터럽트)
    
    > 소프트웨어 사용 중 다른 소프트웨어를 실행하면 시분할 처리르 위해 자원 할당 동작이 수행됨
    > 

# 3. 인터럽트의 처리 과정

- 프로그램 실행 중 인터럽트가 발생
- 현재 수행중인 프로그램 중지
- 인터럽트 처리 후 현 상태로 돌아오기 위해 현재 상태와 데이터를 커널의 데이터 영역에 존재하는 Process Control Block(PCB)에 저장
- 인터럽트 처리(IDT에 따라 인터럽트 처리 함수 실행)
- 스택 영역으로 이동하여 이전 작업 상태로 복귀

### if. 인터럽트 기능이 없다면?

- 컨트롤러는 어떤 동작이 어느 시점에 수행될지 미리 알지 못하기 때문에 계속 동작이 수행되는지 확인을 해야 한다.( ⇒ 폴링)
- 계속 확인을 해야하기 때문에 현재 수행중인 작업의 효율이 떨어지게 된다.

## 4. 컨트롤러가 인터럽트를 인식하는 방법

### 4-1. 폴링 방식

- 사용자가 명령을 직접 사용하여 입력 신호를 계속 읽어 변화를 알아내는 방식
- 인터럽트의 요청을 차례로 비교하여 우선순위가 가장 높은 인터럽트를 찾아 먼저 처리함
- 하드웨어에서 변화를 감지하는 인터럽트 방식보다 느림

### 4-2. 인터럽트 방식

- MCU 자체가 하드웨어적으로 변화를 확인하여 변화 시에만 동작하는 방식
    - Daisy Chain
    - 병렬 우선순위 부여
- 폴링 방식에 비해 신속한 대응이 가능

⇒ 발생시기를 예측하기 힘든 경우 실시간 대응할 수 있으므로 컨트롤러가 가장 빠르게 인터럽트를 처리할 수 있는 방식이다.

## 5. 용어 정리

- SVC 인터럽트(SuperVisor  Call)
    - 사용자가 프로그램을 실행시키거나 OS를 호출하는 경우
    - 사용자가 SVC 명령을 써서 의도적으로 호출한 경우, 복잡한 입출력 처리를 해야하는 경우, 기억장치 할당 및 오퍼레이터와 대화를 해야하는 경우 발생
- IDT(Interrupt Descriptor Table)
    - 시스템 콜이나 0으로 나누기 등 여러 인터럽트를 각각 번호와 실행 코드로 정의해놓은 테이블
    - 컴퓨터 부팅 시 운영체제가 작성
    - 인터럽트가 발생하면 IDT를 확인해서 정의된 인터럽트 처리함수를 실행
- Daisy Chain
    - 인터럽트가 발생하는 모든 장치를 직렬로 연결하고 우선순위가 높은 장치 순서로 정렬하여 우선 순위대로 처리하는 방식
- 병렬 우선순위 부여
    - 인터럽트가 발생하는 장치들을 개별적인 회선으로 연결
    - Mask Register의 비트 위치에 따라 우선순위 결정
    - 우선순위가 높은 것이 실행 중일 때는 우선순위가 낮은 인터럽트는 비활성화
    - 우선순위가 높은 인터럽트는 우선순위가 낮은 인터럽트 처리 중에도 우선 처리됨
- MCU(Micro Cotroller Unit)
    - 마이크로 컨트롤러
    - 전자기기에 탑재되어 ‘제어’나 ‘연산’ 작업을 수행함
    - 주변장치를 제어