# 캐시 메모리

### **캐시메모리**

메인 메모리와 CPU간의 데이터 속도 향상을 위한 중간 버퍼를 역할을 하는 CPU내 또는 외에 존재하는 메모리, 전체 시스템의 성능의 개선을 시킬 수 있는 메모리

**CPU와 메모리의 속도 차이로 위한 병목 현상**을 완화하기 위해 사용

**캐싱**

컴퓨터 처리 성능을 높이기 위한 기법

**메모리 계층구조**

![Untitled](https://user-images.githubusercontent.com/55469012/158582391-d5bcad7c-5264-4de9-a24b-0df94daab66b.png)

캐시메모리는 메모리와 CPU 사이에 위치해 있으며, 메모리 계층 구조에서 레지스터 다음으로 위치

**적중 / 실패**

필요한 데이터가 있을 때 **적중(Hit)**, 없는 경우 **실패(miss)**

적중률 = 케시메모리의 적중 횟수 / 전체 메모리의 참조 횟수

실패율 = 1 - 적중률

CPU는 데이터를 가져오기 위해 캐시메모리 → 메모리 → 보조 기억 장치 순으로 접근

캐시 적중 일 때 : 캐시 메모리의 데이터를 CPU 레지스터에 복사

캐시 실패/메모리 적중일 때 : 메모리 데이터를 캐시 메모리에 복사, 캐시 메모리의 복제된 내용을 CPU 레지스터에 복사

캐시/ 메모리 실패 일 때 : 보조 기억장치에서 필요한 데이터를 메모리에 복사 , 메모리에 복제된 내용을 캐시메모리에 복제, 캐시 메모리의 복제된 데이터를 CPU 레지스터에 복사

캐시 메모리의 성공 여부는 **참조의 지역성 원리**에 달려있음

**지역성의 종류**

시간적 지역성(temporal locality) : CPU가 한 번 참조한 데이터는 다시 참조할 가능성이 높음

공간적 지역성(spatial locality) : CPU가 참조한 데이터와 인접한 데이터 역시 참조될 가능성이 높음

순차적 지역성(sequential locality) : 분기가 발생하지 않는 한 명령어는 메모리에 저장된 순서대로 인출/실행됨

### **캐시 메모리의 구성과 동작**

데이터 요청을 받은 캐시 메모리는 요청받은 데이터를 탐색하는 기능이 필요함

캐시 메모리는 데이터를 관리하기 위해 **데이터 메모리**와 **태그 메모리** 사용

![Untitled 1](https://user-images.githubusercontent.com/55469012/158582434-9452e95e-f14c-48f5-9a65-2a4dbacf6024.png)

블록 : 데이터의 기본 단위인 워드의 집합

데이터 메모리 : 메모리의 데이터들이 저장된 블록으로 구성

태그 메모리 : 데이터 메모리의 블록을 **탐색**할 정보를 포함

태그 메모리의 엔트리는 데이터 메모리 블록과 쌍을 이루면서 태그, 유효 비트, 갱신 비트 포함

CPU주소와 태그를 비교하는 비교기를 가지고 있음

태그 : CPU가 요청한 데이터를 탐색하는데 사용할 주소의 일부

유효 비트 : 캐시블록이 유효한 데이터인지 나타냄

갱신 비트 : 캐시로 블록을 가져온 후 CPU가 블록을 수정했는지 나타냄

**기본적인 동작의 흐름**

CPU가 캐시에 주소 전송 → 태그 메모리 탐색 → 일치하는 태그 발견 (hit) → 블록 상태 갱신(필요할 경우) → 데이터 메모리에서 블록 추출 → 요청받은 데이터 선택 → 캐시가 CPU에 데이터 전송

CPU가 캐시에 주소 전송 → 태그 메모리 탐색 → 일치하는 태그 없음(miss) → 주소를 메모리로 전송해 대응하는 블록을 캐시에 저장 → 요청받은 데이터 선택 → 캐시가 CPU에 데이터 전송

###

### **블록 사상 방식**

즉 블록을 메모리에서 가져와서 캐시에 어떻게, 어디다 가져다 놓을건지를 정하는 것

블록 사상이 필요한 이유는 캐시가 메모리보다 용량이 작기 때문에 다수의 메모리 블록이 동일한 캐시 블록에 사상

블록 사상 방식에는 크게 3가지가 있다.

-   직접 사상(direct mapping) : 메모리 블록을 정해진 하나의 캐시 블록에만 사상할 수 있다.
-   완전 연관 사상(fully-associative mapping) : 메모리 블록을 어떤 캐시 블록에도 사상
-   집합 연관 사상(set-associative mapping) : 직접 사상과 완전 연관 사상을 절충하여, 메모리 블록을 정해진 블록의 집합 내 어디든 사상
